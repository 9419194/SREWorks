package com.alibaba.tdata.sever;

import java.io.InputStreamReader;
import java.io.StringBufferInputStream;

import com.alibaba.fastjson.JSONObject;
import com.alibaba.fastjson.util.IOUtils;

import com.aliyun.tea.Tea;
import com.aliyun.tea.TeaConverter;
import com.aliyun.tea.TeaException;
import com.aliyun.tea.TeaPair;
import com.aliyun.teaopenapi.models.Config;
import com.aliyun.tesla_aiops20220429.Client;
import com.aliyun.tesla_aiops20220429.models.AdAnalyzeRequest;
import com.aliyun.tesla_aiops20220429.models.AdAnalyzeResponse;
import com.aliyun.tesla_aiops20220429.models.AdFeedbackRequest;
import lombok.extern.slf4j.Slf4j;
import org.junit.Test;

/**
 * Unit test for simple App.
 */
@Slf4j
public class AppTest {

    @Test
    public void popAdTest() throws Exception {
        Config config = new com.aliyun.teaopenapi.models.Config();
        config.setAccessKeyId("");
        config.setAccessKeySecret("");
        config.setEndpoint("tesla-aiops-share.cn-zhangjiakou.aliyuncs.com");
        Client client = new com.aliyun.tesla_aiops20220429.Client(config);
        AdAnalyzeRequest request = genRequest();

        AdAnalyzeResponse response = null;
        try {
            response = client.adAnalyze("POP_API", request);
        } catch (TeaException e) {
            log.error("AdAnalyse have Error!", e);
            return;
        }
        System.out.println(response.getBody().toMap());
    }

    @Test
    public void popFeedbackTest() throws Exception{
        Config config = new com.aliyun.teaopenapi.models.Config();
        config.setAccessKeyId("自行填充");
        config.setAccessKeySecret("自行填充");
        config.setEndpoint("tesla-aiops-share.cn-zhangjiakou.aliyuncs.com");
        Client client = new com.aliyun.tesla_aiops20220429.Client(config);
        AdFeedbackRequest adFeedbackRequest = new AdFeedbackRequest();
        adFeedbackRequest.setEntityId("test"); // 时序唯一键（唯一确定一条特定时序）
        JSONObject feedback = new JSONObject(); // 反馈内容，全部放入json对象中
        adFeedbackRequest.setFeedback(feedback);
        client.adFeedback("DQC", adFeedbackRequest);
    }

    private AdAnalyzeRequest genRequest(){
        String str = "{\n"
            + "  \"taskType\": \"sync\",\n"
            + "  \"series\": [\n"
            + "    [\n"
            + "      1641225600,\n"
            + "      15391.1337890625\n"
            + "    ],\n"
            + "    [\n"
            + "      1641225660,\n"
            + "      17223.55078125\n"
            + "    ],\n"
            + "    [\n"
            + "      1641225720,\n"
            + "      15635.00390625\n"
            + "    ],\n"
            + "    [\n"
            + "      1641225780,\n"
            + "      16146.3125\n"
            + "    ],\n"
            + "    [\n"
            + "      1641225840,\n"
            + "      15914.775390625\n"
            + "    ],\n"
            + "    [\n"
            + "      1641225900,\n"
            + "      15924.4794921875\n"
            + "    ],\n"
            + "    [\n"
            + "      1641225960,\n"
            + "      15791.970703125\n"
            + "    ],\n"
            + "    [\n"
            + "      1641226020,\n"
            + "      15637.287109375\n"
            + "    ],\n"
            + "    [\n"
            + "      1641226080,\n"
            + "      15546.31640625\n"
            + "    ],\n"
            + "    [\n"
            + "      1641226140,\n"
            + "      15490.6123046875\n"
            + "    ],\n"
            + "    [\n"
            + "      1641226200,\n"
            + "      15250.00390625\n"
            + "    ],\n"
            + "    [\n"
            + "      1641226260,\n"
            + "      15079.779296875\n"
            + "    ],\n"
            + "    [\n"
            + "      1641226320,\n"
            + "      14856.2958984375\n"
            + "    ],\n"
            + "    [\n"
            + "      1641226380,\n"
            + "      14932.2587890625\n"
            + "    ],\n"
            + "    [\n"
            + "      1641226440,\n"
            + "      14805.875\n"
            + "    ],\n"
            + "    [\n"
            + "      1641226500,\n"
            + "      14736.8876953125\n"
            + "    ],\n"
            + "    [\n"
            + "      1641226560,\n"
            + "      14527.7705078125\n"
            + "    ],\n"
            + "    [\n"
            + "      1641226620,\n"
            + "      14354.75390625\n"
            + "    ],\n"
            + "    [\n"
            + "      1641226680,\n"
            + "      14310.7373046875\n"
            + "    ],\n"
            + "    [\n"
            + "      1641226740,\n"
            + "      14398.283203125\n"
            + "    ],\n"
            + "    [\n"
            + "      1641226800,\n"
            + "      14188.2705078125\n"
            + "    ],\n"
            + "    [\n"
            + "      1641226860,\n"
            + "      14047.7919921875\n"
            + "    ],\n"
            + "    [\n"
            + "      1641226920,\n"
            + "      13847.2412109375\n"
            + "    ],\n"
            + "    [\n"
            + "      1641226980,\n"
            + "      13849.4912109375\n"
            + "    ],\n"
            + "    [\n"
            + "      1641227040,\n"
            + "      13716.3876953125\n"
            + "    ],\n"
            + "    [\n"
            + "      1641227100,\n"
            + "      13727.875\n"
            + "    ],\n"
            + "    [\n"
            + "      1641227160,\n"
            + "      13450.43359375\n"
            + "    ],\n"
            + "    [\n"
            + "      1641227220,\n"
            + "      13364.375\n"
            + "    ],\n"
            + "    [\n"
            + "      1641227280,\n"
            + "      13340.783203125\n"
            + "    ],\n"
            + "    [\n"
            + "      1641227340,\n"
            + "      13295.099609375\n"
            + "    ],\n"
            + "    [\n"
            + "      1641227400,\n"
            + "      13307.30859375\n"
            + "    ],\n"
            + "    [\n"
            + "      1641227460,\n"
            + "      13116.8916015625\n"
            + "    ],\n"
            + "    [\n"
            + "      1641227520,\n"
            + "      12910.0830078125\n"
            + "    ],\n"
            + "    [\n"
            + "      1641227580,\n"
            + "      12960.095703125\n"
            + "    ],\n"
            + "    [\n"
            + "      1641227640,\n"
            + "      12862.2373046875\n"
            + "    ],\n"
            + "    [\n"
            + "      1641227700,\n"
            + "      12862.5498046875\n"
            + "    ],\n"
            + "    [\n"
            + "      1641227760,\n"
            + "      12657.1455078125\n"
            + "    ],\n"
            + "    [\n"
            + "      1641227820,\n"
            + "      12521.779296875\n"
            + "    ],\n"
            + "    [\n"
            + "      1641227880,\n"
            + "      12514.9501953125\n"
            + "    ],\n"
            + "    [\n"
            + "      1641227940,\n"
            + "      12516.19140625\n"
            + "    ],\n"
            + "    [\n"
            + "      1641228000,\n"
            + "      12446.8876953125\n"
            + "    ],\n"
            + "    [\n"
            + "      1641228060,\n"
            + "      12372.3037109375\n"
            + "    ],\n"
            + "    [\n"
            + "      1641228120,\n"
            + "      12127.68359375\n"
            + "    ],\n"
            + "    [\n"
            + "      1641228180,\n"
            + "      12173.337890625\n"
            + "    ],\n"
            + "    [\n"
            + "      1641228240,\n"
            + "      12059.5751953125\n"
            + "    ],\n"
            + "    [\n"
            + "      1641228300,\n"
            + "      12062.662109375\n"
            + "    ],\n"
            + "    [\n"
            + "      1641228360,\n"
            + "      11919.7705078125\n"
            + "    ],\n"
            + "    [\n"
            + "      1641228420,\n"
            + "      11726.650390625\n"
            + "    ],\n"
            + "    [\n"
            + "      1641228480,\n"
            + "      11739.5205078125\n"
            + "    ],\n"
            + "    [\n"
            + "      1641228540,\n"
            + "      11717.7587890625\n"
            + "    ],\n"
            + "    [\n"
            + "      1641228600,\n"
            + "      11590.25390625\n"
            + "    ],\n"
            + "    [\n"
            + "      1641228660,\n"
            + "      11563.7705078125\n"
            + "    ],\n"
            + "    [\n"
            + "      1641228720,\n"
            + "      11325.775390625\n"
            + "    ],\n"
            + "    [\n"
            + "      1641228780,\n"
            + "      11310.12890625\n"
            + "    ],\n"
            + "    [\n"
            + "      1641228840,\n"
            + "      11256.224609375\n"
            + "    ],\n"
            + "    [\n"
            + "      1641228900,\n"
            + "      11374.6044921875\n"
            + "    ],\n"
            + "    [\n"
            + "      1641228960,\n"
            + "      11158.8876953125\n"
            + "    ],\n"
            + "    [\n"
            + "      1641229020,\n"
            + "      11025.8330078125\n"
            + "    ],\n"
            + "    [\n"
            + "      1641229080,\n"
            + "      10919.87890625\n"
            + "    ],\n"
            + "    [\n"
            + "      1641229140,\n"
            + "      10904.4375\n"
            + "    ],\n"
            + "    [\n"
            + "      1641229200,\n"
            + "      10396.154296875\n"
            + "    ],\n"
            + "    [\n"
            + "      1641229260,\n"
            + "      11365.5498046875\n"
            + "    ],\n"
            + "    [\n"
            + "      1641229320,\n"
            + "      10653.4873046875\n"
            + "    ],\n"
            + "    [\n"
            + "      1641229380,\n"
            + "      10631.37890625\n"
            + "    ],\n"
            + "    [\n"
            + "      1641229440,\n"
            + "      10604.5458984375\n"
            + "    ],\n"
            + "    [\n"
            + "      1641229500,\n"
            + "      10698.5458984375\n"
            + "    ],\n"
            + "    [\n"
            + "      1641229560,\n"
            + "      10521.904296875\n"
            + "    ],\n"
            + "    [\n"
            + "      1641229620,\n"
            + "      10349.93359375\n"
            + "    ],\n"
            + "    [\n"
            + "      1641229680,\n"
            + "      10331.25390625\n"
            + "    ],\n"
            + "    [\n"
            + "      1641229740,\n"
            + "      10329.3916015625\n"
            + "    ],\n"
            + "    [\n"
            + "      1641229800,\n"
            + "      10325.1669921875\n"
            + "    ],\n"
            + "    [\n"
            + "      1641229860,\n"
            + "      10216.712890625\n"
            + "    ],\n"
            + "    [\n"
            + "      1641229920,\n"
            + "      571.18359375\n"
            + "    ]\n"
            + "  ],\n"
            + "  \"algoParam\": {\n"
            + "    \"returnBounds\": true\n"
            + "  }\n"
            + "}";
        AdAnalyzeRequest request = JSONObject.parseObject(str, AdAnalyzeRequest.class);
        return request;
    }
}
